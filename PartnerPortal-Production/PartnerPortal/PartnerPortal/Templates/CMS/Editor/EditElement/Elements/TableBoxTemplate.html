<script type="text/javascript">
    var uploaderOpenedBy = {};
    $(document).ready(function () {
        $(".ui-dialog").css("height", $(window).height() - 60);

        //get the object and set values
        var carrierObj = JSON.parse($("#dialog_form").attr("data-obj"));
        try {
            $(".objectProperty").each(function () {
                if ($(this).is('div')) {
                    $(this).html(carrierObj[$(this).attr("data-PropertyIndex")]);
                } else if ($(this).is('textarea')) {
                    if (!(carrierObj[$(this).attr("data-PropertyIndex")] == undefined)) {
                        $(this).val(carrierObj[$(this).attr("data-PropertyIndex")]);
                    }
                } else {
                    if (carrierObj[$(this).attr("data-PropertyIndex")] != null && carrierObj[$(this).attr("data-PropertyIndex")] != undefined && carrierObj[$(this).attr("data-PropertyIndex")].length > 0)
                        $(this).val(carrierObj[$(this).attr("data-PropertyIndex")]);
                }
            });
            tinymce.get('textTableBoxTemplateArea').setContent(carrierObj[556]);
        } catch (e) {

        }

        $(".fusionb-upload-button").click(function () {
            $("#dialog_uploadMedia").empty();
            var template = root + "/Templates/CMS/Editor/UploadMediaTemplate.html";
            $("#dialog_uploadMedia").load(template);
            uploaderOpenedBy = $(this);
            //$("#dialog_uploadMedia").attr("data-allowMultiSelect",false); //Add this line only if you want to add multiselect option
            var dialog = $("#dialog_uploadMedia").dialog({
                autoOpen: false,
                width: "96%",
                modal: true,
                resizable: false,
                position: [30, 30],
                dialogClass: "no-titlebar",
                create: function (event) { $(event.target).parent().css('position', 'fixed'); $(".ui-widget-header").hide(); },
                open: function () { $(".ui-widget-header").hide(); },
                close: function () {
                    $(".ui-widget-header").show();
                    if (selectedUploadedObjectsToUse.length > 0) {
                        uploaderCallback(selectedUploadedObjectsToUse[0].FilePath);
                    }
                }
            });
            dialog.dialog("open");
        });
    });

    function uploaderCallback(filePath) {
        if ($(uploaderOpenedBy) != undefined) {
            //alert(domain);
            //alert(virtualDirectory);
            //alert(filePath);
            //alert(root);
            //filePath = filePath.replace(domain, "../../");
            //alert(filePath);
            tinyMCE.execCommand('mceInsertContent', true, '<img src="' + filePath + '"/>');
        }
    }

    //Start tinymce
    tinymce.remove();
    tinymce.init({
        selector: '#textTableBoxTemplateArea',
        plugins: ['hr link fullscreen table textcolor charmap template code wordcount'],
        menubar: 'false',
        toolbar: 'bold italic strikethrough underline fontsizeselect | bullist numlist blockquote hr alignleft aligncenter alignright alignjustify outdent indent | link unlink fullscreen table styleselect forecolor | removeformat charmap undo redo template code',
        fontsize_formats: '8pt 9pt 10pt 11pt 12pt 14pt 16pt 18pt 20pt 22pt 24px 32px 36px',
        templates: [
            {
                title: 'Test template 1',
                content: 'Test 1'
            }, {
                title: 'Test template 2',
                content: 'Test 2'
            }
        ],
        table_default_styles: {
            width: '100%'
        }
    });
    //End tinymce
</script>
<div style="width: 95%; display: inline-block; position: absolute; left: 2%">
    <div class="clearfix form-element-container form-element-container-select" style="display: none;">
        <div class="name-description"><strong>Type</strong><span>Select the table style</span></div>
        <div class="element-type">
            <div class="select_arrow"></div>
            <select id="fusion_table_type" name="fusion_table_type" class="select-field objectProperty" data-propertyindex="554">
                <option value="1" selected="">Style 1</option>
                <option value="2">Style 2</option>
            </select>
        </div>
    </div>
    <div class="clearfix form-element-container form-element-container-select" style="display: none;">
        <div class="name-description"><strong>Number of Columns</strong><span>Select how many columns to display</span></div>
        <div class="element-type">
            <div class="select_arrow"></div>
            <select id="fusion_table_columns" name="fusion_table_columns" class="select-field objectProperty" data-propertyindex="555">
                <option value="1" selected="">1 Column</option>
                <option value="2">2 Columns</option>
                <option value="3">3 Columns</option>
                <option value="4">4 Columns</option>
                <option value="5">5 Columns</option>
            </select>
        </div>
    </div>
    <div class="clearfix form-element-container form-element-container-html_editor">
        <div class="name-description"><strong>Table</strong><span> </span></div>
        <div class="leftFloat width99p">
            <a href="fusion_image" class="fusionb-upload-button" data-upid="1" style="position: relative;">Add Media</a>
        </div>
        <div class="leftFloat width99p paddingtop5 element-type">
            <textarea id="textTableBoxTemplateArea" class="objectProperty" style="width: 100%; height: 150px; padding-top: 20px;" data-propertyindex="556"></textarea>
        </div>
    </div>
</div>



