<style>
    
    .leftPanelContainer {
        margin-top: 20px; 
        float: right; 
        width: 90%; 
        min-height: 350px;
        margin-right: 40px;
        display: inline-block;
    }
    .leftPanelContent {
        margin-top: 30px;
        width: 100%;
    }
    .leftPanelImage {
	    text-align: center;
    }
    .leftPanelImageC {
	    text-align: left;
    }
    .leftPanelImageI {
        width: 80%;
    }
@@media only screen and (max-width:1399px){
	.leftPanelContainer {
        margin-top: 20px; 
        float: left; 
        width: 90%; 
        min-height: 350px;
        margin-right: 20px;
	    margin-left: 50px;
    }
}
@@media only screen and (max-width:999px){
	.leftPanelContainer {
        margin-top: 20px; 
        float: left; 
        width: 90%; 
        min-height: 350px;
        margin-right: 20px;
	    margin-left: 20px;
    }
}
@@media only screen and (max-width:940px){
	.leftPanelContainer {
        margin-top: 20px; 
        float: left; 
        max-width: 200px; 
        min-height: 350px;
        margin-right: 20px;
	    margin-left: 5px;
    }
}
@@media only screen and (max-width:900px){
    .leftPanelContainer {
        margin-top: 20px; 
        float: none; 
        max-width: 100%;
        width: 100%;
        min-height: 200px;
        margin-right: 20px;
	    margin-left: 5px;
        margin-bottom: 40px;
    }
	.leftPanelImage {
	    width: 48%;
	    float: left;
	    text-align: right;
        margin-right: 10px;
    }
    .leftPanelContent {
	    width: 100%;
        float: left;
        margin-top: 0px;
    }
    .leftPanelImageC {
	    text-align: right;
    }

}

@@media only screen and (max-width:500px){
    .leftPanelImageC {
        padding-top: 45px;
	    text-align: right;
    }
    .leftPanelImageI {
        width: 100%;
    }
}
</style>


<div class="leftPanelContainer" style="background-color: #ECF8FF" ng-controller="PPAdminLeftPanelController">
    <div class="leftPanelContent">
        <div style="font-weight: bold; font-size: 14pt; border-left: 2px solid #8B8B8B; text-align: left; margin-left: 20px; padding-left: 5px;">
            @Html.ActionLink("Log Out >>", "Logout", "Admin")
            <span style="float:right;">
                Year: <select style="width: 150px; padding: 5px; height: 30px; font-size: 11pt;border: 1px solid #d2d2d2; cursor: pointer;" class="clsFieldContainer" ng-model="selectedYearForChart" ng-change="ChangeYear()" ng-options="year as year.name for year in YearsForChart track by year.value">
                   
                </select>               
            </span>
        </div>
        <div style="margin-top: 20px; text-align: center; width: 100%;">
            <canvas id="bar" class="chart chart-bar" chart-colors="chartColorsBar" chart-data="dataBar" chart-labels="labelsBar" chart-series="seriesBar" chart-options="optionsBar" style="display: block; width: 100%; height: 261px;"></canvas>
        </div>
        <div style="margin-top: 60px; text-align: center; width: 100%;">
            <canvas id="pie" class="chart chart-pie" chart-type="typePie" chart-data="dataPie" chart-labels="labelsPie" chart-colors="chartColorsPie" chart-options="optionsPie">
            </canvas>
            <button type="button" class="btn btn-primary pull-right" ng-click="toggle()">Toggle</button>
        </div>

        @*@Html.Partial("Partials/AdminLeftPanelBarChartPartial")
        @Html.Partial("Partials/AdminLeftPanelPieChartPartial")*@
    </div>

</div>
<script>     

        app.controller("PPAdminLeftPanelController", function ($controller, $scope, $http, $sce, 
            notificationFactory, $location,
            validationFactory, filterFilter, helperFactory, dbUtilFactory) {
            //Year
            $scope.currentYearForChart = (new Date()).getFullYear();
            $scope.selectedYearForChart = null;
            $scope.YearsForChart = [];
            for (var i = $scope.currentYearForChart; i >= 2019; i--) {
                obj = {};
                obj.name = i.toString();
                obj.value = i;
                $scope.YearsForChart.push(obj);
            }
            $scope.selectedYearForChart = $scope.YearsForChart[0];
            //alert($scope.YearsForChart.length);
            $scope.ChangeYear = function () {
                $scope.GetVisitsPie();
                $scope.GetVisitsBar();
            };

            //Pie Chart
            $scope.dataPie = [];
            $scope.chartColorsPie = ['#0074D9', '#FF4136', '#2ECC40', '#FF851B', '#7FDBFF', '#B10DC9', '#FFDC00', '#001f3f', '#39CCCC', '#01FF70', '#85144b', '#F012BE', '#3D9970', '#111111', '#AAAAAA'];
            //Pie
            $scope.labelsPie = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            $scope.GetVisitsPie = function () {
                $scope.dataPie = [];
                dbUtilFactory.get(root + 'api/ppcmsapi/GetVisitsAndPageViewsSummary/' + $scope.selectedYearForChart.value, "", function (d) {
                    $scope.dataPie = d.Visits;
                }, '', 'Error getting data ');
            };
            $scope.GetVisitsPie();
            $scope.typePie = 'pie';
            $scope.optionsPie = {
                legend: { display: true },
                title: {
                    display: true,
                    text: "Visits"
                }
            };
            $scope.toggle = function () {
                $scope.typePie = $scope.typePie === 'polarArea' ?
                    'pie' : 'polarArea';

            };


            //Bar chart
            $scope.dataBar = [];
           // $scope.Year = $window.document.getElementById("cmbYearForChart").value;
            $scope.labelsBar = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

            $scope.seriesBar = ['Visits', 'Page Views'];
            //alert($scope.Year);
            $scope.GetVisitsBar = function () {
                $scope.dataBar = [];
                dbUtilFactory.get(root + 'api/ppcmsapi/GetVisitsAndPageViewsSummary/' + $scope.selectedYearForChart.value, "", function (d) {
                    //$scope.Visits = d.Visits;
                    $scope.dataBar.push(d.Visits);
                    $scope.dataBar.push(d.PageViews);
                }, '', 'Error getting data ');
            };
            $scope.GetVisitsBar();

            $scope.optionsBar = { legend: { display: true } };

            $scope.chartColorsBar = ['#803690', '#00ADF9', '#DCDCDC', '#46BFBD', '#FDB45C', '#949FB1', '#4D5360'];


            
        });
    </script>